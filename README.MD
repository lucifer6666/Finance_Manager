# ğŸ’° Finance Manager

A full-stack personal finance management application for tracking transactions, credit cards, salary, and investment portfolio with recurring auto-entry support and advanced analytics.

## ğŸš€ Quick Start

### Prerequisites
- Python 3.8+
- Node.js 16+
- npm or yarn

### Backend Setup

```bash
cd backend
pip install -r requirements.txt
python init_db.py
python -m uvicorn app.main:app --reload
```

Backend runs on: `http://localhost:8000`
API Docs: `http://localhost:8000/docs`

### Frontend Setup

```bash
cd frontend
npm install
npm run dev
```

Frontend runs on: `http://localhost:5173`

## ğŸ“‹ Features

### Transaction Management
- Track income and expenses
- Categorize transactions
- Link transactions to credit cards
- Multiple payment methods (Cash, Card, UPI, Bank)

### Salary Management (NEW)
- Set up recurring monthly salary
- Automatic entry on 1st of each month
- Edit/update salary amount anytime
- Toggle active/inactive status
- Track salary history with last added date

### Credit Card Management
- Track multiple credit cards
- Configure billing cycles and due dates
- Set credit limits
- View spending per card

### Investment Portfolio
- Record investments (Mutual Funds, Stocks, Life Insurance, Crypto, etc.)
- Track initial amount and current value
- Calculate profit/loss
- Auto-entry for recurring investments
  - Monthly recurring contributions
  - Yearly recurring contributions (divided by 12 for monthly calculation)
  - Automatic value updates

### Analytics & Insights
- **Dashboard**: Quick overview with income, expense, investments, and savings
- **Spending Trends**: 12-month trend analysis with monthly breakdown
- **Monthly Analysis**: Deep-dive into specific months with:
  - Income, Expense, Investments, and Savings breakdown
  - Category-wise expense distribution
  - Pie charts for visual analysis
  - AI-generated insights and recommendations
- **Category Analysis**: 
  - Expense categories with percentages
  - Investments shown as a category
  - Top spending categories highlighted
- **Yearly Summaries**: Full year overview with monthly breakdowns

## ğŸ—ï¸ Technology Stack

### Backend
- **FastAPI 0.104.1** - REST API framework
- **SQLAlchemy 2.0.23** - ORM for database
- **SQLite** - Local database
- **Pydantic 2.5.0** - Data validation
- **Python 3.x** - Server-side language

### Frontend
- **React 18.2.0** - UI library
- **Vite 7.3.0** - Build tool & dev server
- **TypeScript 5.2.2** - Type safety
- **Tailwind CSS 3.3.6** - Utility-first styling
- **Recharts 2.10.3** - Data visualization
- **Axios 1.6.2** - HTTP client

## ğŸ“ Project Structure

```
Finance_Manager/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ main.py              # FastAPI app setup
â”‚   â”‚   â”œâ”€â”€ database.py          # SQLAlchemy configuration
â”‚   â”‚   â”œâ”€â”€ models.py            # ORM models (Transaction, CreditCard, SavingsInvestment, Salary)
â”‚   â”‚   â”œâ”€â”€ schemas.py           # Pydantic schemas
â”‚   â”‚   â”œâ”€â”€ crud.py              # Database operations
â”‚   â”‚   â”œâ”€â”€ routers/
â”‚   â”‚   â”‚   â”œâ”€â”€ transactions.py  # Transaction endpoints
â”‚   â”‚   â”‚   â”œâ”€â”€ cards.py         # Credit card endpoints
â”‚   â”‚   â”‚   â”œâ”€â”€ analytics.py     # Analytics endpoints
â”‚   â”‚   â”‚   â”œâ”€â”€ savings.py       # Investment endpoints
â”‚   â”‚   â”‚   â””â”€â”€ salary.py        # Salary endpoints (NEW)
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â””â”€â”€ analytics.py     # Calculation utilities (updated for investments)
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ init_db.py              # Database initialization
â”‚   â””â”€â”€ finance_manager.db      # SQLite database (auto-created)
â””â”€â”€ frontend/
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ pages/
    â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx         # Main dashboard
    â”‚   â”‚   â”œâ”€â”€ TransactionsPage.tsx  # Transaction management
    â”‚   â”‚   â”œâ”€â”€ CreditCardsPage.tsx   # Credit card management
    â”‚   â”‚   â”œâ”€â”€ SavingsPage.tsx       # Investment portfolio
    â”‚   â”‚   â”œâ”€â”€ SalaryPage.tsx        # Salary management (NEW)
    â”‚   â”‚   â”œâ”€â”€ AnalyticsPage.tsx     # Advanced analytics with monthly analysis
    â”‚   â”‚   â””â”€â”€ index.ts
    â”‚   â”œâ”€â”€ components/
    â”‚   â”‚   â”œâ”€â”€ AddTransactionForm.tsx
    â”‚   â”‚   â”œâ”€â”€ AddSavingsForm.tsx
    â”‚   â”‚   â”œâ”€â”€ SalaryManagement.tsx   # Salary UI component (NEW)
    â”‚   â”‚   â”œâ”€â”€ CategoryPieChart.tsx
    â”‚   â”‚   â”œâ”€â”€ MonthlyChart.tsx
    â”‚   â”‚   â”œâ”€â”€ CreditCardSummary.tsx
    â”‚   â”‚   â”œâ”€â”€ TransactionTable.tsx
    â”‚   â”‚   â”œâ”€â”€ SavingsInvestmentTable.tsx
    â”‚   â”‚   â”œâ”€â”€ InsightPanel.tsx
    â”‚   â”‚   â””â”€â”€ Navbar.tsx
    â”‚   â”œâ”€â”€ hooks/
    â”‚   â”‚   â”œâ”€â”€ useTransactions.ts
    â”‚   â”‚   â”œâ”€â”€ useCreditCards.ts
    â”‚   â”‚   â”œâ”€â”€ useSavings.ts
    â”‚   â”‚   â”œâ”€â”€ useAnalytics.ts
    â”‚   â”‚   â””â”€â”€ useSalaries.ts         # Salary management hook (NEW)
    â”‚   â”œâ”€â”€ api/
    â”‚   â”‚   â””â”€â”€ client.ts             # API client with salary endpoints (updated)
    â”‚   â”œâ”€â”€ types/
    â”‚   â”‚   â””â”€â”€ index.ts              # TypeScript type definitions
    â”‚   â”œâ”€â”€ App.tsx                   # Main app with routing
    â”‚   â””â”€â”€ index.css
    â”œâ”€â”€ package.json
    â””â”€â”€ vite.config.ts
```

## ğŸ“Š Key Features Explained

### Salary Auto-Entry System
- Create salary entries with:
  - **Name**: Salary identifier (e.g., "Primary Salary", "Bonus")
  - **Monthly Amount**: The recurring amount
  - **Start Date**: When the salary was initialized (NEW - Session 5)
  - **Active Status**: Toggle to enable/disable auto-entry
  - **Description**: Optional notes
- System automatically creates income transactions on 1st of month
- Salaries appear in Analytics and Dashboard
- Can be toggled active/inactive to pause auto-entry
- Track salary history with "Started" and "Last Added" dates

### Investment Calculation Logic
- **Non-recurring investments**: Counted only in purchase month
- **Monthly recurring**: Full amount counted each month
- **Yearly recurring**: Divided by 12 and counted as monthly equivalent
- **In Analytics**: Investments display separately AND as a category in breakdowns

### Monthly Analysis Page
- Toggle between "Spending Trends" (12-month) and "Monthly Analysis" (deep-dive)
- Monthly Analysis includes:
  - Summary cards showing Income, Expense, Investments, Savings, and Savings Rate
  - Category distribution pie chart
  - Detailed category breakdown with amounts and percentages
  - AI-generated insights based on spending patterns

## ğŸ”„ Data Flow

```
Frontend (React + TypeScript)
    â†“ (HTTP with Axios)
API Routes (FastAPI routers)
    â†“
Business Logic (CRUD operations)
    â†“
Database (SQLite with SQLAlchemy ORM)
    â†“
Analytics Utils (Calculate summaries and insights)
```

## ğŸš¦ Running the Application

### Development Mode

Terminal 1 (Backend):
```bash
cd backend
python -m uvicorn app.main:app --reload
```

Terminal 2 (Frontend):
```bash
cd frontend
npm run dev
```

Then open `http://localhost:5173` in your browser.

### API Documentation
Once backend is running, visit `http://localhost:8000/docs` for interactive API documentation.

## ğŸ“ˆ Current Statistics

- **Models**: 4 (Transaction, CreditCard, SavingsInvestment, Salary)
- **API Endpoints**: 30+ endpoints across 5 routers
- **Pages**: 6 (Dashboard, Transactions, Cards, Savings, Analytics, Salary)
- **Components**: 15+ reusable React components
- **Hooks**: 5 custom React hooks for data management

## ğŸ› Known Issues & Fixes

### âœ… Fixed Issues
- December date calculation bug (year rollover)
- Route ordering in savings router
- Database schema mismatch (purchase_date column)
- Pydantic validation for top_categories
- Investment calculation to prevent double-counting
- Dashboard crashes when investments present

## ğŸ”’ Security Notes

1. **CORS**: Currently allows all origins (update for production)
2. **Authentication**: Not implemented (add before production)
3. **Input Validation**: All inputs validated via Pydantic
4. **SQL Injection**: Protected via SQLAlchemy ORM
5. **Rate Limiting**: Not implemented (add before public release)

## ğŸ”® Future Enhancements

- [ ] User authentication and multi-user support
- [ ] Data export to CSV/Excel
- [ ] Budget alerts and notifications
- [ ] Tax report generation
- [ ] Multi-currency support
- [ ] Investment goal tracking
- [ ] Recurring expense templates
- [ ] Mobile app (React Native)
- [ ] Dark mode
- [ ] Advanced filtering and search
- [ ] Data backup and restore functionality

## ğŸ“ Important Notes

1. **Database**: SQLite file created automatically in backend folder
2. **CORS**: Configure for production use
3. **Hot Reload**: Both frontend and backend support hot reload in dev mode
4. **Date Format**: All dates stored as ISO format (YYYY-MM-DD)
5. **Investment Logic**: Yearly recurring investments are smart-calculated as monthly equivalent
6. **Salary Processing**: Happens daily, but only processes on 1st of month

## ğŸ¤ Contributing

When adding new features:
1. Update both backend and frontend simultaneously
2. Update MEMORY.md with session notes
3. Update README.md with new features
4. Test thoroughly with sample data
5. Keep TypeScript and Python type hints strict

## ğŸ“ Support

For issues or questions about the application, refer to the API documentation at `/docs` endpoint when backend is running.
â”‚   â””â”€â”€ finance.db              # SQLite database (auto-created)
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/              # Page components
â”‚   â”‚   â”œâ”€â”€ components/         # Reusable components
â”‚   â”‚   â”œâ”€â”€ services/           # API service layer
â”‚   â”‚   â”œâ”€â”€ hooks/              # Custom React hooks
â”‚   â”‚   â”œâ”€â”€ types/              # TypeScript interfaces
â”‚   â”‚   â”œâ”€â”€ App.tsx             # Main app component
â”‚   â”‚   â””â”€â”€ index.css           # Global styles
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ MEMORY.md                   # Development memory & notes
â”œâ”€â”€ README.md                   # This file
â”œâ”€â”€ .gitignore                  # Git ignore patterns
â””â”€â”€ README.TXT                  # Original readme
```

## ğŸ—„ï¸ Database Schema

### Transaction
```
- id (Primary Key)
- date (Date)
- amount (Float)
- type (income | expense)
- category (String)
- description (Optional)
- payment_method (cash | card | upi | bank)
- credit_card_id (Foreign Key, Optional)
- created_at (DateTime)
```

### CreditCard
```
- id (Primary Key)
- name (String)
- bank_name (String)
- billing_cycle_start (Day of month)
- billing_cycle_end (Day of month)
- due_date (Day of month)
- credit_limit (Float)
- created_at (DateTime)
- transactions (Relationship)
```

### SavingsInvestment
```
- id (Primary Key)
- name (String)
- investment_type (mutual_fund | life_insurance | fixed_deposit | stock | crypto | other)
- purchase_date (Date)
- initial_amount (Float)
- current_value (Float)
- description (Optional)
- is_recurring (Boolean)
- recurring_type (monthly | yearly | null)
- recurring_amount (Float, Optional)
- last_recurring_date (Date, Optional)
- created_at (DateTime)
- updated_at (DateTime)
```

## ğŸ”Œ API Endpoints

### Transactions
```
GET    /api/transactions              # List all
POST   /api/transactions              # Create
GET    /api/transactions/{id}         # Get by ID
PUT    /api/transactions/{id}         # Update
DELETE /api/transactions/{id}         # Delete
```

### Credit Cards
```
GET    /api/cards                     # List all
POST   /api/cards                     # Create
GET    /api/cards/{id}                # Get by ID
PUT    /api/cards/{id}                # Update
DELETE /api/cards/{id}                # Delete
GET    /api/cards/{id}/billing        # Billing info
```

### Investments
```
GET    /api/savings                   # List all investments
POST   /api/savings                   # Create investment
GET    /api/savings/comparison/current # Investment vs account comparison
GET    /api/savings/{id}              # Get by ID
PUT    /api/savings/{id}              # Update investment
DELETE /api/savings/{id}              # Delete investment
POST   /api/savings/process/recurring # Process recurring investments
```

### Analytics
```
GET    /api/analytics/monthly         # Monthly summary
GET    /api/analytics/yearly          # Yearly summary
GET    /api/analytics/category        # Category breakdown
```

## ğŸ¨ UI Components

### Pages
- **TransactionsPage** - Manage transactions with filters
- **CreditCardsPage** - Manage credit cards and billing
- **SavingsPage** - View investments and portfolio performance
- **AnalyticsPage** - View financial insights and charts

### Forms
- **AddTransactionForm** - Record income/expenses
- **AddSavingsForm** - Add investments (with recurring options)
- **AddCreditCardForm** - Register credit cards

### Components
- Dashboard - Overview of finances
- Charts - Visualization using Recharts
- Loading states - Spinner for async operations
- Error handling - User-friendly error messages

## ğŸ“ Styling

### Color Scheme
- **Primary**: Blue-600 (#2563EB)
- **Secondary**: Gray-700 (#374151)
- **Text**: Black for labels, White for inputs
- **Background**: White pages, Gray-700 for form inputs
- **Accents**: Green for profit, Red for loss

### Typography
- **Headings**: Bold, Black text
- **Labels**: Small, Bold, Black text
- **Inputs**: White text on Gray-700 background
- **Buttons**: Blue with hover effects

## ğŸ”§ Configuration

### Backend (.env)
```
DATABASE_URL=sqlite:///./finance_manager.db
```

### CORS Settings
- Allowed origins: `http://localhost:5173`
- Methods: GET, POST, PUT, DELETE
- Credentials: Enabled

## ğŸ› Known Issues & Fixes

### âœ… December Date Calculation Bug (FIXED)
Date arithmetic for next month now properly handles year boundary.

### âœ… Route Ordering (FIXED)
Endpoint `/comparison/current` moved before `/{investment_id}` for correct matching.

### âœ… Database Schema Mismatch (FIXED)
Added missing `purchase_date` column to investments table.

### âœ… Data Preservation (FIXED)
Database initialization now preserves existing data while adding new columns.

## ğŸ“Š Recurring Investments

### How It Works
1. **Enable Recurring**: Check "Set up auto-entry" when creating/updating investment
2. **Set Frequency**: Choose Monthly or Yearly
3. **Set Amount**: Enter recurring contribution amount
4. **Auto-Update**: System automatically updates `current_value` on schedule
5. **Track**: `last_recurring_date` tracks when last update occurred

### API Usage
```bash
# Process all recurring investments
POST http://localhost:8000/api/savings/process/recurring
```

## ğŸš€ Deployment

### Production Build
```bash
# Frontend
cd frontend
npm run build

# Backend
cd backend
pip install -r requirements.txt
uvicorn app.main:app --host 0.0.0.0 --port 8000
```

### Docker Support (Optional)
```bash
docker-compose up -d
```

## ğŸ“š Development Notes

- All dates use ISO format (YYYY-MM-DD)
- API responses include timestamps in ISO 8601 format
- Validation errors return 422 Unprocessable Entity
- Not found errors return 404
- Server errors return 500 with error message

## ğŸ¤ Contributing

1. Create a branch for your feature
2. Make changes following the existing code style
3. Test thoroughly
4. Update MEMORY.md with important notes
5. Commit with clear messages

## ğŸ“„ License

Private project - Finance Manager

## ğŸ“ Support

For issues or questions, refer to MEMORY.md for development context and troubleshooting.
